"use strict";function n(n){return n&&"object"==typeof n&&"default"in n?n.default:n}var e=require("react"),t=n(e),r=require("react-spring"),o=require("react-use-gesture"),i=n(require("styled-components")),a=require("react-color"),u=require("react-spring/three");function c(n,e){return e||(e=n.slice(0)),n.raw=e,n}function l(){var n=c(["\n  display: flex;\n  font-family: sans-serif;\n  white-space: nowrap;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.75);\n  justify-content: flex-end;\n  ","\n  ","\n"]);return l=function(){return n},n}function f(){var n=c(["\n  display: flex;\n  ","\n  justify-content: flex-end;\n  padding: 0 8px;\n"]);return f=function(){return n},n}function s(){var n=c(["\n  display: flex;\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n  width: 56px;\n  user-select: none;\n  ","\n"]);return s=function(){return n},n}function d(){var n=c(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 8px 0;\n"]);return d=function(){return n},n}var p=i.div(d()),b=i.label(s(),function(n){return!0===n.flexLabel?"flex: 1;":""}),x=i.div(f(),function(n){return!0!==n.flexLabel?"flex: 1;":""}),m=i.div(l(),function(n){return n.stack?"flex: 1;":""},function(n){return n.stack?"":"width: 42px;"});function g(n){var e=n.htmlFor,r=n.label,o=n.flexLabel,i=n.value,a=n.children;return n.stack?t.createElement("div",null,t.createElement(p,null,t.createElement(b,{flexLabel:o},r),t.createElement(m,{stack:!0,flexLabel:o},i)),a):t.createElement(p,null,t.createElement(b,{flexLabel:o,htmlFor:e},r),t.createElement(x,{flexLabel:o},a),void 0!==i&&t.createElement(m,null,i))}function v(){var n=c(["\n  opacity: 0;\n  margin-right: -15px;\n  & + ",":after {\n    position: absolute;\n    content: '';\n    display: inline-block;\n    height: 4px;\n    width: 8px;\n    border-left: 2px solid;\n    border-bottom: 2px solid;\n    left: 3px;\n    top: 4px;\n    opacity: 0;\n    transform: translate(0px, 2px) rotate(-45deg);\n    transition: ease-in-out 125ms;\n    transition-property: opacity, transform;\n  }\n  &:checked + ",":after {\n    opacity: 1;\n    transform: translate(0px, 0px) rotate(-45deg);\n  }\n  &:checked + "," {\n    background: rgba(0, 0, 0, 0.045);\n    border-color: rgba(0, 0, 0, 0.085);\n  }\n"]);return v=function(){return n},n}function h(){var n=c(["\n  height: 16px;\n  width: 16px;\n  border: 2px solid rgba(0, 0, 0, 0.065);\n  border-radius: 4px;\n  position: relative;\n  margin-top: -1px;\n  transition: ease-in-out 125ms;\n  transition-property: background-color, border-color;\n"]);return h=function(){return n},n}var y=i.label(h()),E=i.input(v(),y,y,y);function k(){var n=c(["\n  display: block;\n\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n\n  display: block;\n  position: relative;\n\n  width: 100%;\n  height: 32px;\n\n  color: #000;\n\n  border: 0;\n  background-color: rgba(0, 0, 0, 0.045);\n  border-radius: 4px;\n  padding: 0 4px;\n"]);return k=function(){return n},n}var w=i.button(k());function C(){var n=c(["\n  position: absolute;\n  top: 24px;\n  right: 0px;\n  z-index: 100;\n"]);return C=function(){return n},n}function L(){var n=c(["\n  width: 32px;\n  height: 16px;\n  border: 2px solid white;\n  box-shadow: 0 0 1px 0 rgba(0, 0, 0, 0.3);\n  cursor: pointer;\n"]);return L=function(){return n},n}function S(){var n=c(["\n  position: relative;\n"]);return S=function(){return n},n}var F=i.div(S()),R=i.div(L()),z=i.div(C()),j={type:"number",value:0},q=function(n){if(void 0!==n.value)return n.value;switch(n.type){case"number":return 0;case"color":return"#ff0000";case"string":return"";case"select":return(n.items||[""])[0];case"boolean":return!1;case"xypad":return{x:0,y:0}}return 0},T=function(n,e,t){return t?Math.min(Math.max(n,e),t):Math.min(n,e)},A=function(n,e,t,r,o){return(n-e)*(o-r)/(t-e)+r};function M(){var n=c(["\n  -webkit-appearance: none;\n  width: 100%;\n  background: transparent;\n  display: inline-block;\n\n  &:focus {\n    outline: none;\n  }\n\n  &::-webkit-slider-runnable-track {\n    width: 100%;\n    height: 12px;\n    cursor: pointer;\n    background: rgba(0, 0, 0, 0.045);\n    border-radius: 10px;\n  }\n\n  &::-webkit-slider-thumb {\n    border: none;\n    height: 20px;\n    width: 20px;\n    border-radius: 50%;\n    background: #ffffff;\n    cursor: pointer;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.22);\n    -webkit-appearance: none;\n    margin-top: -4px;\n  }\n\n  &:focus::-webkit-slider-runnable-track {\n    outline: none;\n  }\n"]);return M=function(){return n},n}var O=i.input(M());function D(){var n=c(["\n  display: block;\n\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n\n  display: block;\n  position: relative;\n\n  width: 100%;\n  height: 32px;\n\n  color: #000;\n\n  margin-left: 8px;\n\n  border: 0;\n  background-color: rgba(0, 0, 0, 0.025);\n  border-radius: 4px;\n  padding: 0 4px;\n"]);return D=function(){return n},n}var P=i.select(D());function U(){var n=c(["\n  display: block;\n\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n\n  display: block;\n  position: relative;\n\n  width: 100%;\n  height: 32px;\n\n  color: #000;\n\n  margin-left: 8px;\n\n  border: 0;\n  background-color: rgba(0, 0, 0, 0.025);\n  border-radius: 4px;\n  padding: 0 4px;\n"]);return U=function(){return n},n}var I=i.input(U()),G={number:function(n){var r=n.control,o=n.value,i=e.useRef(null),a=e.useRef(null),u=r.config,c=u.min,l=void 0===c?u.scrub?-Infinity:0:c,f=u.max,s=void 0===f?u.scrub?Infinity:Math.PI:f,d=u.distance;d||(d=u.scrub?2:s-l);var p=e.useState(u.scrub?150:A(o,l,s,0,300)),b=p[0],x=p[1],m=e.useCallback(function(){u.scrub&&(x(150),a.current=null)},[u.scrub]);return e.useEffect(function(){var n=i.current;return n&&n.addEventListener("change",m),function(){n&&n.removeEventListener("change",m)}},[m,i]),t.createElement(g,{label:r.name,value:o.toFixed(2)},t.createElement(O,{ref:i,type:"range",value:b,min:0,max:300,onChange:function(n){var e=Number(n.currentTarget.value);x(e),null===a.current&&(a.current=o);var t=(u.scrub?a.current:0)+A(e-(u.scrub?150:0),0,300,u.scrub?0:l,u.scrub?2*d:s);r.set(T(t,l,s))}}))},boolean:function(n){var e=n.control,r="Control"+e.id.current;return t.createElement(g,{flexLabel:!0,label:e.name,htmlFor:r},t.createElement(E,{id:r,type:"checkbox",checked:n.value,onChange:function(n){return e.set(n.currentTarget.checked)}}),t.createElement(y,{htmlFor:r}))},select:function(n){var e=n.control;return t.createElement(g,{label:e.name},t.createElement(P,{value:n.value,onChange:function(n){return e.set(n.currentTarget.value)}},e.config.items.map(function(n,e){return t.createElement("option",{key:e},n)})))},color:function(n){var r=n.control,o=n.value,i=e.useState(!1),u=i[0],c=i[1],l=e.useRef(),f=function(n){l.current&&!l.current.contains(n.target)&&c(!1)};return e.useEffect(function(){return document.body.addEventListener("click",f),function(){document.body.removeEventListener("click",f)}},[]),t.createElement(g,{label:r.name,flexLabel:!0},t.createElement(F,null,t.createElement(R,{style:{backgroundColor:o},onClick:function(){return c(function(n){return!n})}}),t.createElement(z,{hidden:!0!==u,ref:l},t.createElement(a.ChromePicker,{color:o,onChange:function(n){return r.set(n.hex)},disableAlpha:!0}))))},string:t.memo(function(n){var e=n.control;return t.createElement(g,{label:e.name},t.createElement(I,{value:n.value,onChange:function(n){return e.set(n.target.value)}}))}),button:function(n){var e=n.control;return t.createElement("div",{style:{paddingTop:8,paddingBottom:8}},t.createElement(w,{onClick:function(){e.config.onClick&&e.config.onClick()}},e.name))},xypad:t.memo(function(n){var e=n.control,i=n.value,a=t.useRef(),u=t.useRef(null),c=e.config,l=c.distance,f=void 0===l?1:l,s=c.scrub,d=void 0!==s&&s,p=t.useState({width:270,height:152})[0],b=p.width,x=p.height,m=r.useSpring(function(){return{from:{x:i.x,y:i.y},onFrame:function(n){var t=n.y;if(!d){var r=T(A(n.x,0,b/2,0,f),-f,f)||0,o=T(A(t,0,x/2,0,f),-f,f)||0;e.set(function(){return{x:r<1e-5&&r>-1e-5?0:r,y:o<1e-5&&o>-1e-5?0:o}})}}}}),v=m[0],h=m[1],y=o.useDrag(function(n){var t=n.down,r=n.movement;t&&!u.current?u.current=i:t||(u.current=null),h({x:t?r[0]:0,y:t?r[1]:0}),d&&t&&e.set(function(){return{x:u.current.x+A(r[0],0,b/2,0,f),y:u.current.y+A(r[1],0,x/2,0,f)}})}),E=v.x.interpolate(function(n){return T(n+b/2,0,b)}),k=v.y.interpolate(function(n){return T(n+x/2,0,x)});return t.createElement(g,{stack:!0,label:e.name,value:"x: "+i.x.toFixed(1)+", y: "+i.y.toFixed(1)},t.createElement(r.animated.svg,Object.assign({ref:a,style:{userSelect:"none",borderRadius:8,border:"1px solid #f0f0f0"},width:b,height:x,xmlns:"http://www.w3.org/2000/svg"},y()),t.createElement("rect",{fill:"rgb(250, 250, 250)",width:"100%",height:"100%"}),t.createElement(r.animated.line,{x1:E,x2:E,y1:0,y2:"100%",stroke:"#ccc"}),t.createElement(r.animated.line,{x1:0,x2:"100%",y1:k,y2:k,stroke:"#ccc"}),t.createElement(r.animated.g,{style:{transform:r.interpolate([E,k],function(n,e){return"translate("+n+"px, "+e+"px)"})}},t.createElement("circle",{r:8,fill:"#ccc"}),t.createElement("circle",{r:4,fill:"#aaa"}))))})};function V(n){var r=n.control,o=r.config.component||G[r.config.type],i=e.useState(q(r.config)),a=i[0],u=i[1];return e.useEffect(function(){r.addEventListener(u)},[]),o?t.createElement(o,{key:r.id.current,control:r,value:a}):null}function _(){var n=c(["\n  background: ",";\n  padding: 16px;\n  display: ",";\n  margin-bottom: 8px;\n"]);return _=function(){return n},n}function B(){var n=c(['\n  display: block;\n  font-family: sans-serif;\n  font-size: 13px;\n  font-weight: bold;\n  padding-left: 16px;\n  cursor: pointer;\n  position: relative;\n  user-select: none;\n\n  &:before,\n  &:after {\n    content: "";\n    position: absolute;\n    top: 8px;\n    right: 16px;\n    width: 12px;\n    height: 2px;\n    background-color: #333;\n    /* transition: transform 0.25s ease-out; */\n  }\n  &:before {\n    transform: rotate(',"deg);\n  }\n\n  &:after{\n    transform: rotate(","deg);\n  }\n"]);return B=function(){return n},n}var H=i.h2(B(),function(n){return n.open?0:90},function(n){return n.open?0:180}),N=i.div(_(),function(n){return n.bg?"#f9f9f9":"#fff"},function(n){return n.open?"block":"none"}),W=function(n){var r=n.title,o=n.controls,i=e.useState(!0),a=i[0],u=i[1],c="DEFAULT_GROUP"!==r;return t.createElement("div",null,c&&t.createElement(H,{open:a,onClick:function(){return u(function(n){return!n})}},r),t.createElement(N,{open:a,bg:c},Array.from(o).map(function(n){return t.createElement(V,{key:n[0].current,control:n[1]})})))};function J(){var n=c(["\n  padding-bottom: 8px;\n"]);return J=function(){return n},n}function K(){var n=c(["\n  display: flex;\n  align-items: center;\n  padding-left: 16px;\n  padding-right: 16px;\n  height: 42px;\n  font-family: sans-serif;\n  font-size: 14px;\n  color: #fff;\n  cursor: move;\n  cursor: grab;\n  user-select: none;\n  background-color: #000;\n  border-top-left-radius: 8px;\n  border-top-right-radius: 8px;\n  box-shadow: 0 0 14px 0 rgba(0, 0, 0, 0.14);\n"]);return K=function(){return n},n}function Q(){var n=c(["\n  display: block;\n  position: fixed;\n  top: 16px;\n  right: 16px;\n  width: ","px;\n  border-radius: 16px;\n  background-color: #fff;\n  border-radius: 8px;\n  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.12);\n"]);return Q=function(){return n},n}var X=i(r.animated.div)(Q(),300),Y=i(r.animated.div)(K()),Z=i.div(J()),$=t.memo(function(){var n,i=r.useSpring(function(){return{pos:[0,0]}}),a=i[0].pos,u=i[1],c=o.useDrag(function(n){var e=n.movement,t=n.memo,r=void 0===t?a.getValue?a.getValue():a.get():t;return u({pos:[T(e[0]+r[0],300-window.innerWidth+32,1),T(e[1]+r[1],0,window.innerHeight-350)]}),r}),l=e.useState(0)[1];return e.useEffect(function(){en.update=function(){return l(function(n){return n+1}),null}},[]),t.createElement(X,{style:{transform:r.interpolate([a],function(n){return"translate3d("+n[0]+"px,"+n[1]+"px,0)"})}},t.createElement(Y,Object.assign({},c())),t.createElement(Z,null,Object.entries((n=tn,Array.from(n).reduce(function(n,e){var t=e[1].config.group||"DEFAULT_GROUP";return n[t]=n[t]||[],n[t].push(e),n},{}))).map(function(n){var e=n[0];return t.createElement(W,{key:e,title:e,controls:n[1]})})))}),nn=0,en={update:function(){return null}},tn=new Map;exports.Controls=$,exports.controls=tn,exports.controlsEmitter=en,exports.useControl=function(n,t){void 0===t&&(t=j);var r=e.useRef(nn++),o=e.useRef(),i=e.useState(q(t)),a=i[0],c=i[1],l=u.useSpring(function(){return{value:a,config:"object"==typeof t.spring?t.spring:void 0}}),f=l[0],s=l[1];return t.state&&(a=t.state[0],c=t.state[1]),e.useEffect(function(){return tn.set(r,{id:r,name:n,set:c,value:a,config:t,addEventListener:function(n){o.current=n}}),en.update(),function(){tn.delete(r),en.update()}},[]),e.useEffect(function(){t.spring&&s({value:a}),o.current&&o.current(a),t.onChange&&t.onChange(a)},[a]),t.spring?f.value:a};
//# sourceMappingURL=react-three-gui.cjs.production.min.js.map
